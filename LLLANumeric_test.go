package main

import (
	"testing"
)

func Test_LLLANumeric_Encode(t *testing.T) {
	value := "12345"
	expected := []byte{
		0x31, 0x30, 0x33,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
		0x31, 0x32, 0x33, 0x34, 0x35}
	codec := LLLANumeric{"", `Should be 103000000000000000000000000000000000000000` +
		`0000000000000000000000000000000000000000000000000000000000012345`, 103, true}
	actual, err := codec.Encode(value)
	checkEncodeResult(t, expected, actual, err)

	expected = []byte("00512345")
	codec = LLLANumeric{"", `Should be 00512345`, 103, false}
	actual, err = codec.Encode(value)
	checkEncodeResult(t, expected, actual, err)
}

func Test_LLLANumeric_EncodeInvalidLength(t *testing.T) {
	value := "12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901"
	codec := LLLANumeric{"", "Should return LLL length error", 100, false}
	actual, err := codec.Encode(value)
	checkEncodeError(t, actual, err, InvalidLengthError)
}

func Test_LLLANumeric_EncodeInvalidFormat(t *testing.T) {
	value := "12345ABC"
	codec := LLLANumeric{"", "Should return nil, error", 199, false}
	actual, err := codec.Encode(value)
	checkEncodeError(t, actual, err, NumberFormatError)
}

func Test_LLLANumeric_EncodeInvalidLength2(t *testing.T) {
	value := `1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890` +
		`1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890` +
		`1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890` +
		`1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890` +
		`1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890` +
		`1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890` +
		`1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890` +
		`1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890` +
		`1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890` +
		`1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890`
	codec := LLLANumeric{"", "Should return error", 999, false}
	actual, err := codec.Encode(value)
	checkEncodeError(t, actual, err, InvalidLengthError)
}

func Test_LLLANumeric_Decode(t *testing.T) {
	value := []byte(`103000000000000000000000000000000000000000` +
		`0000000000000000000000000000000000000000000000000000000000012345`)
	expected := `00000000000000000000000000000000000000000000000000` +
		`00000000000000000000000000000000000000000000000012345`
	codec := LLLANumeric{"", `Should be 000000000000000000000000000000000000000` +
		`0000000000000000000000000000000000000000000000000000000000012345`, 103, true}
	actual, err := codec.Decode(value)
	checkDecodeResult(t, expected, actual, err)
}
